(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-index"],{"04e0":function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("a6c0")),r=new i.default([{key:"REGISTER",name:"账户注册设置",value:"register"},{key:"PAGE_CATEGORY_TEMPLATE",name:"分类页模板",value:"page_category_template"},{key:"POINTS",name:"积分设置",value:"points"},{key:"RECHARGE",name:"充值设置",value:"recharge"}]);e.default=r},"1ba2":function(t,e,n){"use strict";n("ac1f"),n("5319"),n("14d9");var a=Object.prototype.hasOwnProperty;function i(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}function r(t){try{return encodeURIComponent(t)}catch(e){return null}}e.stringify=function(t,e){e=e||"";var n,i,o=[];for(i in"string"!==typeof e&&(e="?"),t)if(a.call(t,i)){if(n=t[i],n||null!==n&&void 0!==n&&!isNaN(n)||(n=""),i=r(i),n=r(n),null===i||null===n)continue;o.push(i+"="+n)}return o.length?e+o.join("&"):""},e.parse=function(t){var e,n=/([^=?#&]+)=?([^&]*)/g,a={};while(e=n.exec(t)){var r=i(e[1]),o=i(e[2]);null===r||null===o||r in a||(a[r]=o)}return a}},"20a4":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* 引入uView全局scss变量文件 */.tips[data-v-71362856]{width:%?700?%;margin:%?0?% auto;font-size:%?28?%;color:#999}.wechat-auth[data-v-71362856]{width:%?400?%;margin:%?40?% auto 0 auto;margin-top:%?50?%}.wechat-auth .wechat-auth-container[data-v-71362856]{display:flex;justify-content:center}.wechat-auth .icon[data-v-71362856]{width:%?38?%;height:%?38?%;margin-right:%?15?%}.wechat-auth .title[data-v-71362856]{font-size:%?32?%;margin-left:%?10?%;color:#fff}.btn-normal[data-v-71362856]{line-height:%?90?%;background-color:#09ca09;color:#fff;border-radius:%?50?%}',""]),t.exports=e},2427:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var a={uForm:n("53b5").default,uFormItem:n("252b").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"container"},[t.showhead?[n("v-uni-view",{staticStyle:{display:"flex","flex-direction":"column","align-items":"center",width:"100%"}},[n("v-uni-button",{staticClass:"avatar-wrapper",attrs:{"open-type":"chooseAvatar"},on:{chooseavatar:function(e){arguments[0]=e=t.$handleEvent(e),t.onChooseAvatar.apply(void 0,arguments)}}},[n("v-uni-image",{staticClass:"avatar",attrs:{src:t.avatarUrl}})],1),n("u-form",{ref:"uForm",staticStyle:{width:"100%","font-size":"36rpx"},attrs:{model:t.form}},[n("u-form-item",{attrs:{label:"昵称"}},[n("v-uni-input",{staticClass:"weui-input",attrs:{type:"nickname",placeholder:"请输入昵称"},model:{value:t.userInfo.nickname,callback:function(e){t.$set(t.userInfo,"nickname",e)},expression:"userInfo.nickname"}})],1)],1)],1)]:[n("v-uni-view",{staticClass:"wechatapp"},[n("v-uni-view",{staticClass:"header"},[n("v-uni-image",{staticClass:"image",attrs:{src:t.storeInfo&&t.storeInfo.image_url?t.storeInfo.image_url:"/static/default-avatar.png"}})],1)],1),n("v-uni-view",{staticClass:"auth-title"},[t._v("申请获取以下权限")]),n("v-uni-view",{staticClass:"auth-subtitle"},[t._v("获得你的公开信息（昵称、头像等）")]),n("v-uni-view",{staticClass:"login-btn"},[n("v-uni-button",{staticClass:"button btn-normal",on:{click:function(e){e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.getUserProfile.apply(void 0,arguments)}}},[t._v("授权登录")])],1),n("v-uni-view",{staticClass:"no-login-btn"},[n("v-uni-button",{staticClass:"button btn-normal",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleCancel.apply(void 0,arguments)}}},[t._v("暂不登录")])],1)]],2)},r=[]},3416:function(t,e,n){"use strict";n("7a82");var a=n("dbce").default,i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n("c7eb")),o=i(n("1da1"));n("d3b7"),n("a9e3");var s=i(n("8d3b")),u=n("67b7"),c=i(n("6d73")),d=a(n("e551")),l=a(n("7f84")),f={data:function(){return{avatarUrl:"https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0",storeInfo:void 0,code:"",userInfo:{nickname:"",image_id:""},showhead:!1}},created:function(){this.getStoreInfo()},methods:{getStoreInfo:function(){var t=this;c.default.item("store").then((function(e){return t.storeInfo=e}))},getCode:function(){return new Promise((function(t,e){uni.login({provider:"weixin",success:function(e){t(e.code)},fail:e})}))},getUserProfile:function(t){var e=this;wx.canIUse("getUserProfile")&&wx.getUserProfile({lang:"zh_CN",desc:"获取用户相关信息",success:function(t){var n=t.userInfo;console.log("用户同意了授权"),console.log("userInfo：",n),e.onAuthSuccess(n)},fail:function(){console.log("用户拒绝了授权")}})},onChooseAvatar:function(t){var e=this;if(t.detail.avatarUrl){this.storeInfo.image_url=t.detail.avatarUrl;var n={};n.path=t.detail.avatarUrl,l.image([n]).then((function(t){e.image_id=t[0]}))}},onAuthSuccess:function(t){var e=this;return(0,o.default)((0,r.default)().mark((function n(){var a;return(0,r.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e,console.log("登录"),n.t0=s.default,n.next=5,a.getCode();case 5:n.t1=n.sent,n.t2=t,n.t3={code:n.t1,oauth:"MP-WEIXIN",userInfo:n.t2},n.t4=s.default.getters.refereeId,n.t5={partyData:n.t3,refereeId:n.t4},n.t0.dispatch.call(n.t0,"LoginMpWx",n.t5).then((function(t){console.log("登录成功？？"),a.$toast(t.message),setTimeout((function(){var e="";t.data.userId&&""!=t.data.userId&&(e=t.data.userId),a.onNavigateBack(1,e)}),2e3)})).catch((function(e){var n=e.result.data;if((0,u.isEmpty)(n)&&a.$toast(e.result.message),n.isBack){var i="";e.result.data.userId&&""!=e.result.data.userId&&(i=e.result.data.userId),console.log("登录成功",i),setTimeout((function(){return a.onNavigateBack(1,i)}),2e3)}n.isBindMobile&&a.onEmitSuccess(t)}));case 11:case"end":return n.stop()}}),n)})))()},onEmitSuccess:function(t){var e=this;return(0,o.default)((0,r.default)().mark((function n(){var a;return(0,r.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e,n.t0=a,n.next=4,a.getCode();case 4:n.t1=n.sent,n.t2=t,n.t3={oauth:"MP-WEIXIN",code:n.t1,userInfo:n.t2},n.t0.$emit.call(n.t0,"success",n.t3);case 8:case"end":return n.stop()}}),n)})))()},handleCancel:function(){this.onNavigateBack()},insertPid:function(t){t.pid&&d.insertPid(t).then((function(t){console.log("这里？？？？pid"),uni.removeStorageSync("pid")})).catch((function(t){}))},onNavigateBack:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0,n=this;console.log("user_id",e,"pid=======",uni.getStorageSync("pid")),e&&""!=e&&uni.getStorageSync("pid")&&(console.log("pid_"),n.insertPid({user_id:e,pid:uni.getStorageSync("pid")}));var a=getCurrentPages();a.length>1?uni.navigateBack({delta:Number(t||1)}):this.$navTo("pages/index/index")}}};e.default=f},"360e":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* 引入uView全局scss变量文件 */.container[data-v-cfdd46aa]{padding:%?100?% %?60?%;min-height:100vh;background-color:#fff}.tab-item[data-v-cfdd46aa]{width:50%;display:flex;justify-content:center;align-items:center}.tab-item uni-view[data-v-cfdd46aa]{line-height:%?70?%}.action[data-v-cfdd46aa]{border-bottom:%?5?% solid #5066dd;color:#5066dd}.header[data-v-cfdd46aa]{margin-bottom:%?60?%}.header .title[data-v-cfdd46aa]{color:#191919;font-size:%?54?%}.header .sub-title[data-v-cfdd46aa]{margin-top:%?20?%;color:#b3b3b3;font-size:%?28?%}.form-item[data-v-cfdd46aa]{display:flex;padding:%?18?%;border-bottom:%?1?% solid #f3f1f2;margin-bottom:%?30?%;height:%?96?%}.form-item--input[data-v-cfdd46aa]{font-size:%?28?%;letter-spacing:%?1?%;flex:1;height:100%}.form-item--parts[data-v-cfdd46aa]{min-width:%?100?%;height:100%}.form-item .captcha[data-v-cfdd46aa]{height:100%}.form-item .captcha .image[data-v-cfdd46aa]{display:block;width:%?192?%;height:100%}.form-item .captcha-sms[data-v-cfdd46aa]{font-size:%?28?%;line-height:%?50?%;padding-right:%?20?%}.form-item .captcha-sms .un-activate[data-v-cfdd46aa]{color:#9e9e9e}.register[data-v-cfdd46aa]{width:100%;height:%?70?%;margin-top:%?80?%;text-align:center}.register-button[data-v-cfdd46aa]{margin-left:%?18?%;font-size:%?36?%;color:var(--main-bg)}.login-button[data-v-cfdd46aa]{width:100%;height:%?86?%;margin-top:%?0?%;background:linear-gradient(90deg,#f50,#fa0);color:#fff;border-radius:%?80?%;box-shadow:0 10px 20px 0 rgba(0,0,0,.1);letter-spacing:%?5?%;display:flex;justify-content:center;align-items:center}',""]),t.exports=e},3793:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var a={uIcon:n("0648").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("v-uni-view",{staticClass:"tips"},[t._v("第一次登录需要绑定手机号")]),n("v-uni-view",{staticClass:"wechat-auth"},[n("v-uni-button",{staticClass:"btn-normal",attrs:{"open-type":"getPhoneNumber"},on:{getphonenumber:function(e){arguments[0]=e=t.$handleEvent(e),t.handelMpWeixinMobileLogin(e)},click:function(e){arguments[0]=e=t.$handleEvent(e),t.clickPhoneNumber.apply(void 0,arguments)}}},[n("v-uni-view",{staticClass:"wechat-auth-container"},[n("u-icon",{attrs:{name:"weixin-fill",color:"#fff",size:"36"}}),n("v-uni-text",{staticClass:"title"},[t._v("微信手机号一键登录")])],1)],1)],1)],1)},r=[]},4550:function(t,e,n){"use strict";var a=n("a993"),i=n.n(a);i.a},"48a1":function(t,e,n){"use strict";n("7a82");var a=n("dbce").default,i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n("c7eb")),o=i(n("1da1"));n("ac1f"),n("841c"),n("5319"),n("a9e3");var s=i(n("1ba2")),u=i(n("8d3b")),c=n("67b7"),d=a(n("b46d")),l={data:function(){return{isCallback:!1}},created:function(){this.onCallback(),this.redirectUrl()},methods:{onCallback:function(){var t=this,e=s.default.parse(window.location.search);if((0,c.isEmpty)(e)){var n=this.$route.query;!(0,c.isEmpty)(n)&&n.code&&(this.isCallback=!0,d.oauthUserInfo(n.code).then((function(e){var n=e.data;console.log("用户同意了授权"),console.log("userInfo：",n),t.onAuthSuccess(n)})))}else{var a=window.location.href.replace(window.location.search,"");window.location.href=a+"?"+(0,c.urlEncode)(e)}},onAuthSuccess:function(t){var e=this;return(0,o.default)((0,r.default)().mark((function n(){var a,i,o,s;return(0,r.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=t.userInfo,i=t.encryptedData,o=t.iv,s=e,u.default.dispatch("LoginWxOfficial",{partyData:{oauth:"H5-WEIXIN",userInfo:a,encryptedData:i,iv:o},refereeId:u.default.getters.refereeId}).then((function(t){s.$toast(t.message),setTimeout((function(){var e="";t.data.userId&&""!=t.data.userId&&(e=t.data.userId),s.onNavigateBack(1,e)}),2e3)})).catch((function(t){var e=t.result.data;(0,c.isEmpty)(e)&&s.$toast(t.result.message),e.isBindMobile&&s.onEmitSuccess({userInfo:a,encryptedData:i,iv:o})}));case 3:case"end":return n.stop()}}),n)})))()},redirectUrl:function(){if(!this.isCallback){var t=window.location.href;d.oauthUrl(t).then((function(t){var e=t.data.redirectUrl;window.location.href=e}))}},onEmitSuccess:function(t){var e=this;return(0,o.default)((0,r.default)().mark((function n(){var a,i,o;return(0,r.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:a=t.userInfo,i=t.encryptedData,o=t.iv,e.$emit("success",{oauth:"H5-WEIXIN",userInfo:a,encryptedData:i,iv:o});case 2:case"end":return n.stop()}}),n)})))()},insertPid:function(t){t.pid&&auctionApi.insertPid(t).then((function(t){uni.removeStorageSync("pid")})).catch((function(t){}))},onNavigateBack:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0,n=this;e&&""!=e&&uni.getStorageSync("pid")&&n.insertPid({user_id:e,pid:uni.getStorageSync("pid")});var a=getCurrentPages();a.length>1?uni.navigateBack({delta:Number(t||1)}):this.$navTo("pages/index/index")}}};e.default=l},"48e4":function(t,e,n){"use strict";n.r(e);var a=n("3793"),i=n("ebe4");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("f546");var o=n("f0c5"),s=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"71362856",null,!1,a["a"],void 0);e["default"]=s.exports},"6d73":function(t,e,n){"use strict";n("7a82");var a=n("dbce").default,i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("d3b7");var r=i(n("7df2")),o=i(n("5aaf")),s=a(n("8545")),u=function(t){return void 0==t&&(t=r.default.get("enabledSettingCache")),new Promise((function(e,n){var a=function(){return o.default.get("Setting")}();t&&a?e(a):function(){return new Promise((function(t,e){s.data().then((function(e){t(e.data.setting)}))}))}().then((function(t){(function(t){o.default.set("Setting",t,600)})(t),e(t)}))}))},c={data:u,item:function(t,e){return new Promise((function(n,a){u(e).then((function(e){n(e[t])}))}))},h5Url:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise((function(e,n){u(t).then((function(t){var n=t["_other"]["h5Url"];e(n)}))}))}};e.default=c},"761b":function(t,e,n){"use strict";n.r(e);var a=n("f370"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},"786b":function(t,e,n){"use strict";n.r(e);var a=n("aea8"),i=n("f035");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);var o=n("f0c5"),s=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"7179ac7b",null,!1,a["a"],void 0);e["default"]=s.exports},"7c95":function(t,e,n){"use strict";n.r(e);var a=n("2427"),i=n("a8a0");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("4550");var o=n("f0c5"),s=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"3268c85d",null,!1,a["a"],void 0);e["default"]=s.exports},"7eeb":function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("c7eb")),r=a(n("1da1")),o=a(n("8eb66")),s=a(n("7c95")),u=a(n("fcd9")),c=a(n("04e0")),d=a(n("6d73")),l={components:{Main:o.default,MpWeixin:s.default,WxOfficial:u.default},data:function(){return{isLoad:!1,setting:{},isMpWeixinAuth:!1,isWxOfficialAuth:!1,isParty:!1,partyData:{}}},onLoad:function(t){var e=this;return(0,r.default)((0,i.default)().mark((function t(){return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getRegisterSetting();case 2:return t.next=4,e.setShowUserInfo();case 4:e.isLoad=!0;case 5:case"end":return t.stop()}}),t)})))()},methods:{getRegisterSetting:function(){var t=this;return(0,r.default)((0,i.default)().mark((function e(){return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d.default.item(c.default.REGISTER.value,!1).then((function(e){return t.setting=e}));case 2:case"end":return e.stop()}}),e)})))()},setShowUserInfo:function(){var t=this;return(0,r.default)((0,i.default)().mark((function e(){var n,a,r;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t,a="MP-WEIXIN"===n.platform&&wx.canIUse("getUserProfile"),r="H5-WEIXIN"===n.platform,n.isMpWeixinAuth=a&&n.setting.isOauthMpweixin,n.isWxOfficialAuth=r&&n.setting.isOauthWxofficial;case 5:case"end":return e.stop()}}),e)})))()},onGetUserInfoSuccess:function(t){this.partyData=t,this.onShowRegister()},onShowRegister:function(){"MP-WEIXIN"===this.partyData.oauth&&(this.isMpWeixinAuth=!1),"H5-WEIXIN"===this.partyData.oauth&&(this.isWxOfficialAuth=!1),this.isParty=!0}}};e.default=l},"7f84":function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.image=void 0,n("d3b7"),n("d81d");var i=a(n("1601"));e.image=function(t){return new Promise((function(e,n){i.default.urlFileUpload({files:t,maxSize:2097152}).then((function(t){return e(t.map((function(t){return t.data.fileInfo.file_id})),t)})).catch(n)}))}},8093:function(t,e,n){"use strict";var a=n("f6d2"),i=n.n(a);i.a},8545:function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.data=function(){return i.default.get(r.data)};var i=a(n("1601")),r={data:"setting/data"}},"8c33":function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.image=function(){return i.default.get(r.image,{},{load:!1})},e.sendSmsCaptcha=function(t){return i.default.post(r.sendSmsCaptcha,t,{load:!1})};var i=a(n("1601")),r={image:"captcha/image",sendSmsCaptcha:"captcha/sendSmsCaptcha"}},"8eb66":function(t,e,n){"use strict";n.r(e);var a=n("915d"),i=n("761b");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("8093");var o=n("f0c5"),s=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"cfdd46aa",null,!1,a["a"],void 0);e["default"]=s.exports},"915d":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"container"},[n("v-uni-view",{staticClass:"header"},[n("v-uni-view",{staticStyle:{width:"700rpx",display:"flex","justify-content":"center","align-items":"center","margin-bottom":"30rpx"}},[n("v-uni-view",{staticClass:"tab-item"},[n("v-uni-view",{class:{action:0==t.logintype},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeType(0)}}},[t._v("密码登录")])],1),n("v-uni-view",{staticClass:"tab-item"},[n("v-uni-view",{class:{action:1==t.logintype},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeType(1)}}},[t._v("短信登录")])],1)],1),n("v-uni-view",{staticClass:"sub-title"})],1),1==t.logintype?[n("v-uni-view",{staticClass:"login-form"},[n("v-uni-view",{staticClass:"form-item"},[n("v-uni-input",{staticClass:"form-item--input",attrs:{type:"number",maxlength:"11",placeholder:"请输入手机号码"},on:{blur:function(e){arguments[0]=e=t.$handleEvent(e),t.getUser()}},model:{value:t.mobile,callback:function(e){t.mobile=e},expression:"mobile"}})],1),n("v-uni-view",{staticClass:"form-item"},[n("v-uni-input",{staticClass:"form-item--input",attrs:{type:"text",maxlength:"5",placeholder:"请输入图形验证码"},model:{value:t.captchaCode,callback:function(e){t.captchaCode=e},expression:"captchaCode"}}),n("v-uni-view",{staticClass:"form-item--parts"},[n("v-uni-view",{staticClass:"captcha",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getCaptcha()}}},[n("v-uni-image",{staticClass:"image",attrs:{src:t.captcha.base64}})],1)],1)],1),n("v-uni-view",{staticClass:"form-item"},[n("v-uni-input",{staticClass:"form-item--input",attrs:{type:"number",maxlength:"6",placeholder:"请输入短信验证码"},model:{value:t.smsCode,callback:function(e){t.smsCode=e},expression:"smsCode"}}),n("v-uni-view",{staticClass:"form-item--parts"},[n("v-uni-view",{staticClass:"captcha-sms",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handelSmsCaptcha()}}},[t.smsState?n("v-uni-text",{staticClass:"un-activate"},[t._v("重新发送("+t._s(t.times)+")秒")]):n("v-uni-text",{staticClass:"activate"},[t._v("获取验证码")])],1)],1)],1),n("v-uni-view",{staticClass:"register"},[n("v-uni-text",[t._v("没有账号？请先"),n("v-uni-text",{staticClass:"register-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toRegister()}}},[t._v("注册")])],1)],1),n("v-uni-view",{staticClass:"login-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleLogin.apply(void 0,arguments)}}},[n("v-uni-text",[t._v("登录")])],1)],1)]:[n("v-uni-view",{staticClass:"login-form"},[n("v-uni-view",{staticClass:"form-item"},[n("v-uni-input",{staticClass:"form-item--input",attrs:{type:"number",maxlength:"11",placeholder:"请输入手机号码"},model:{value:t.mobile,callback:function(e){t.mobile=e},expression:"mobile"}})],1),n("v-uni-view",{staticClass:"form-item"},[n("v-uni-input",{staticClass:"form-item--input",attrs:{type:"password",maxlength:"11",placeholder:"请输入密码"},model:{value:t.pwd,callback:function(e){t.pwd=e},expression:"pwd"}})],1),n("v-uni-view",{staticClass:"register"},[n("v-uni-text",[t._v("没有账号？请先"),n("v-uni-text",{staticClass:"register-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toRegister()}}},[t._v("注册")])],1)],1),n("v-uni-view",{staticClass:"login-button",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.loginByPwd.apply(void 0,arguments)}}},[n("v-uni-text",[t._v("登录")])],1)],1)]],2)},i=[]},a6c0:function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("d9e2"),n("d401"),n("d81d"),n("14d9"),n("c975");var i=a(n("d4ec")),r=a(n("bee2")),o=function(){function t(e){var n=this;(0,i.default)(this,t);var a=[],r=[];if(!Array.isArray(e))throw new Error("param is not an array!");e.map((function(t){t.key&&t.name&&(a.push(t.key),r.push(t.value),n[t.key]=t,t.key!==t.value&&(n[t.value]=t))})),this.data=e,this.keyArr=a,this.valueArr=r}return(0,r.default)(t,[{key:"keyOf",value:function(t){return this.data[this.keyArr.indexOf(t)]}},{key:"valueOf",value:function(t){return this.data[this.valueArr.indexOf(t)]}},{key:"getNameByKey",value:function(t){var e=this.keyOf(t);if(!e)throw new Error("No enum constant"+t);return e.name}},{key:"getNameByValue",value:function(t){var e=this.valueOf(t);if(!e)throw new Error("No enum constant"+t);return e.name}},{key:"getValueByKey",value:function(t){var e=this.keyOf(t);if(!e)throw new Error("No enum constant"+t);return e.key}},{key:"getData",value:function(){return this.data}}]),t}(),s=o;e.default=s},a8a0:function(t,e,n){"use strict";n.r(e);var a=n("3416"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},a938:function(t,e,n){"use strict";n("7a82");var a=n("dbce").default,i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("d3b7"),n("a9e3");var r=i(n("c7eb")),o=i(n("1da1")),s=i(n("8d3b")),u=n("67b7"),c=a(n("e551")),d={props:{isParty:{type:Boolean,default:function(){return!1}},partyData:{type:Object}},data:function(){return{code:""}},methods:{clickPhoneNumber:function(){var t=this;return(0,o.default)((0,r.default)().mark((function e(){return(0,r.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getCode();case 2:t.code=e.sent;case 3:case"end":return e.stop()}}),e)})))()},handelMpWeixinMobileLogin:function(t){var e=this;return(0,o.default)((0,r.default)().mark((function n(){var a,i;return(0,r.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=t.detail,i=e,"getPhoneNumber:ok"==a.errMsg){n.next=5;break}return console.log("微信授权获取手机号失败",a.errMsg),n.abrupt("return");case 5:"getPhoneNumber:ok"==a.errMsg&&(i.isLoading=!0,s.default.dispatch("LoginMpWxMobile",{code:i.code,encryptedData:a.encryptedData,iv:a.iv,isParty:i.isParty,partyData:i.partyData,refereeId:s.default.getters.refereeId}).then((function(t){i.$toast(t.message),setTimeout((function(){var e="";t.data.userId&&""!=t.data.userId&&(e=t.data.userId),e&&""!=e&&uni.getStorageSync("pid")&&i.insertPid({user_id:e,pid:uni.getStorageSync("pid")}),setTimeout((function(){uni.redirectTo({url:"/userpage/updateInfo?menu_id="+t.data.menu_id})}))}),2e3)})).catch((function(t){var e=t.result.data;if((0,u.isEmpty)(e)&&i.$toast(t.result.message),e.isBack){var n="";t.result.data.userId&&""!=t.result.data.userId&&(n=t.result.data.userId),t.result.message&&i.$toast(t.result.message),setTimeout((function(){return i.onNavigateBack(1,n)}),2e3)}})).finally((function(){return i.isLoading=!1})));case 6:case"end":return n.stop()}}),n)})))()},getCode:function(){return new Promise((function(t,e){uni.login({provider:"weixin",success:function(e){console.log("code",e.code),t(e.code)},fail:e})}))},insertPid:function(t){t.pid&&c.insertPid(t).then((function(t){uni.removeStorageSync("pid")})).catch((function(t){}))},onNavigateBack:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0,n=this;e&&""!=e&&uni.getStorageSync("pid")&&n.insertPid({user_id:e,pid:uni.getStorageSync("pid")});var a=getCurrentPages();a.length>1?uni.navigateBack({delta:Number(t||1)}):this.$navTo("pages/user/index")}}};e.default=d},a993:function(t,e,n){var a=n("d588");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("2eac60dc",a,!0,{sourceMap:!1,shadowMode:!1})},aea8:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isLoad?n("v-uni-view",{staticClass:"login",style:t.appThemeStyle},[t.isMpWeixinAuth?n("MpWeixin",{on:{success:function(e){arguments[0]=e=t.$handleEvent(e),t.onGetUserInfoSuccess.apply(void 0,arguments)}}}):t.isWxOfficialAuth?n("WxOfficial",{on:{success:function(e){arguments[0]=e=t.$handleEvent(e),t.onGetUserInfoSuccess.apply(void 0,arguments)}}}):n("Main",{attrs:{isParty:t.isParty,partyData:t.partyData}})],1):t._e()},i=[]},b2e3:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this.$createElement,e=this._self._c||t;return e("div")},i=[]},b46d:function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.oauthUserInfo=e.oauthUrl=void 0;var i=a(n("1601")),r={oauthUrl:"wxofficial/oauthUrl",oauthUserInfo:"wxofficial/oauthUserInfo"};e.oauthUrl=function(t){return i.default.get(r.oauthUrl,{callbackUrl:t})};e.oauthUserInfo=function(t){return i.default.get(r.oauthUserInfo,{code:t})}},ca23:function(t,e,n){"use strict";n("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.isPositiveInteger=e.isPhone=e.isNumber=e.isMobile=e.isInteger=e.isEmpty=e.isEmail=e.isDouble=void 0,n("498a"),n("ac1f"),n("00b4"),n("466d");e.isEmpty=function(t){return""==t.trim()};e.isPhone=function(t){return/^((0\d{2,3}-\d{7,8})|(1[3456789]\d{9}))$/.test(t)};e.isMobile=function(t){return/^(1[3456789]\d{9})$/.test(t)};e.isEmail=function(t){if(null==t||""==t)return!1;var e=t.match(/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/);return null!=e};e.isNumber=function(t){return!(!i(t)&&!a(t))};e.isPositiveInteger=function(t){return/(^[0-9]\d*$)/.test(t)};var a=function(t){if(null==t||""==t)return!1;var e=t.match(/^[-\+]?\d+$/);return null!=e};e.isInteger=a;var i=function(t){if(null==t||""==t)return!1;var e=t.match(/^[-\+]?\d+(\.\d+)?$/);return null!=e};e.isDouble=i},cdaa:function(t,e,n){"use strict";n.r(e);var a=n("48a1"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},d588:function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */\n/* 引入uView全局scss变量文件 */.container[data-v-3268c85d]{padding:0 %?60?%;font-size:%?32?%;background:#fff;min-height:100vh}.wechatapp[data-v-3268c85d]{padding:%?80?% 0 %?48?%;border-bottom:%?1?% solid #e3e3e3;margin-bottom:%?72?%;text-align:center}.wechatapp .header[data-v-3268c85d]{width:%?190?%;height:%?190?%;border:%?4?% solid #fff;margin:0 auto 0;border-radius:50%;overflow:hidden;box-shadow:%?2?% 0 %?10?% rgba(50,50,50,.3)}.wechatapp .header .image[data-v-3268c85d]{display:block;width:100%;height:100%}.auth-title[data-v-3268c85d]{color:#585858;font-size:%?34?%;margin-bottom:%?40?%}.auth-subtitle[data-v-3268c85d]{color:#888;margin-bottom:%?88?%;font-size:%?28?%}.login-btn[data-v-3268c85d]{padding:0 %?20?%}.login-btn .button[data-v-3268c85d]{height:%?88?%;background:#04be01;color:#fff;font-size:%?30?%;border-radius:%?999?%;display:flex;justify-content:center;align-items:center}.no-login-btn[data-v-3268c85d]{margin-top:%?20?%;padding:0 %?20?%}.no-login-btn .button[data-v-3268c85d]{height:%?88?%;background:#dfdfdf;color:#fff;font-size:%?30?%;border-radius:%?999?%;display:flex;justify-content:center;align-items:center}.avatar-wrapper[data-v-3268c85d]{padding:0;width:56px!important;border-radius:8px;margin-top:40px;margin-bottom:40px}.avatar[data-v-3268c85d]{display:block;width:56px;height:56px}',""]),t.exports=e},e551:function(t,e,n){"use strict";n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.updatePayPwd=e.tjfx=e.insertPid=e.getUsermobile=e.getQhtMx=e.getCodeShare=void 0;var i=a(n("1601")),r={tjfx:"zuser/tjfx",getCode_url:"user/get_user_Icode",getuser_url:"zlease/getUser",updatePayPwd_url:"Zuser/pwdPay",getQhtmx_url:"zuser/pointsLog",insertPid:"zuser/insertPid"};e.insertPid=function(t){return i.default.get(r.insertPid,t)};e.getQhtMx=function(t){return i.default.get(r.getQhtmx_url,t)};e.updatePayPwd=function(t){return i.default.post(r.updatePayPwd_url,t)};e.getUsermobile=function(t){return i.default.post(r.getuser_url,t)};e.tjfx=function(t){return i.default.get(r.tjfx,t)};e.getCodeShare=function(t){return i.default.post(r.getCode_url,t)}},e77c:function(t,e,n){var a=n("20a4");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("39712553",a,!0,{sourceMap:!1,shadowMode:!1})},ebe4:function(t,e,n){"use strict";n.r(e);var a=n("a938"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},f035:function(t,e,n){"use strict";n.r(e);var a=n("7eeb"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},f370:function(t,e,n){"use strict";n("7a82");var a=n("dbce").default,i=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("d3b7"),n("a9e3");var r=i(n("8d3b")),o=a(n("ce25")),s=a(n("8c33")),u=a(n("ca23")),c=i(n("48e4")),d=a(n("e551")),l={components:{MpWeixinMobile:c.default},props:{isParty:{type:Boolean,default:function(){return!1}},partyData:{type:Object}},data:function(){return{pwd:"",logintype:0,isLoading:!1,captcha:{},smsState:!1,times:60,mobile:"",captchaCode:"",smsCode:"",icode:"",is_exist:!1}},created:function(){this.getCaptcha()},methods:{getUser:function(){var t=this;if(this.validteMobile(this.mobile)){var e={mobile:this.mobile};o.userIsExist(e).then((function(e){console.log(e),1==e.data.status?t.is_exist=!0:(t.$toast("用户不存在，先去注册吧"),uni.navigateTo({url:"./register",fail:function(t){console.log(t)}}))})).catch((function(t){console.log(t)}))}},toRegister:function(){uni.navigateTo({url:"./register",fail:function(t){console.log(t)}})},changeType:function(t){2==t&&uni.getClipboardData({success:function(t){this.icode=t.data},fail:function(t){console.log(t)}}),this.logintype=t},getCaptcha:function(){var t=this;s.image().then((function(e){return t.captcha=e.data}))},handelSmsCaptcha:function(){this.isLoading||this.smsState||!this.formValidation(10)||this.sendSmsCaptcha()},formValidation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,e=this;return!!(10!==t||e.validteMobile(e.mobile)&&e.validteCaptchaCode(e.captchaCode))&&!!(20!==t||e.validteMobile(e.mobile)&&e.validteSmsCode(e.smsCode))},pwdFromValidte:function(){return!(!this.validtePwd(this.pwd)||!this.validteMobile(this.mobile))},validtePwd:function(t){return!u.isEmpty(t)||(this.$toast("请先输入密码"),!1)},validteMobile:function(t){return u.isEmpty(t)?(this.$toast("请先输入手机号"),!1):!!u.isMobile(t)||(this.$toast("请输入正确格式的手机号"),!1)},validteCaptchaCode:function(t){return!u.isEmpty(t)||(this.$toast("请先输入图形验证码"),!1)},validteSmsCode:function(t){return!u.isEmpty(t)||(this.$toast("请先输入短信验证码"),!1)},sendSmsCaptcha:function(){var t=this;t.isLoading=!0,s.sendSmsCaptcha({form:{captchaKey:t.captcha.key,captchaCode:t.captchaCode,mobile:t.mobile}}).then((function(e){t.$toast(e.message),t.timer()})).catch((function(){return t.getCaptcha()})).finally((function(){return t.isLoading=!1}))},timer:function(){var t=this;t.smsState=!0;var e=setInterval((function(){t.times=t.times-1,t.times<=0&&(t.smsState=!1,t.times=60,clearInterval(e))}),1e3)},loginByPwd:function(){!this.isLoading&&this.pwdFromValidte()&&this.submitData()},submitData:function(){var t=this;t.isLoading=!0,r.default.dispatch("LoginByPwd",{mobile:t.mobile,password:t.pwd}).then((function(e){console.log("登录成功",e),t.$toast(e.message),setTimeout((function(){var n="";e.data.userId&&""!=e.data.userId&&(n=e.data.userId),t.onNavigateBack(1,n)}),2e3)})).catch((function(e){if(console.log("登录失败",e),e.result.data.isBack){var n="";e.result.data.userId&&""!=e.result.data.userId&&(n=e.result.data.userId),setTimeout((function(){return t.onNavigateBack(1,n)}),2e3)}})).finally((function(){return t.isLoading=!1}))},handleLogin:function(){!this.isLoading&&this.formValidation(20)&&this.submitLogin()},submitLogin:function(){var t=this;t.isLoading=!0,r.default.dispatch("Login",{smsCode:t.smsCode,mobile:t.mobile,isParty:t.isParty,partyData:t.partyData,refereeId:r.default.getters.refereeId}).then((function(e){t.$toast(e.message),setTimeout((function(){var n="";e.data.userId&&""!=e.data.userId&&(n=e.data.userId),t.onNavigateBack(1,n)}),2e3)})).catch((function(e){if(e.result.data.isBack){var n="";e.result.data.userId&&""!=e.result.data.userId&&(n=e.result.data.userId),setTimeout((function(){return t.onNavigateBack(1,n)}),2e3)}})).finally((function(){return t.isLoading=!1}))},insertPid:function(t){t.pid&&d.insertPid(t).then((function(t){uni.removeStorageSync("pid")})).catch((function(t){}))},onNavigateBack:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0,n=this;e&&""!=e&&uni.getStorageSync("pid")&&n.insertPid({user_id:e,pid:uni.getStorageSync("pid")});var a=getCurrentPages();a.length>1?uni.navigateBack({delta:Number(t||1)}):this.$navTo("pages/index/index")}}};e.default=l},f546:function(t,e,n){"use strict";var a=n("e77c"),i=n.n(a);i.a},f6d2:function(t,e,n){var a=n("360e");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("6b83327e",a,!0,{sourceMap:!1,shadowMode:!1})},fcd9:function(t,e,n){"use strict";n.r(e);var a=n("b2e3"),i=n("cdaa");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);var o=n("f0c5"),s=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],void 0);e["default"]=s.exports}}]);